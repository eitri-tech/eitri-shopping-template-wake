const eloPattern = () => {
	let exp =
		'^(' +
		'4011(78|79)' +
		'|43(1274|8935)' +
		'|45(' +
		'1416' +
		'|7393' +
		'|763(1|2)' +
		')' +
		'|50(4175|6699|67[0-7][0-9]|9000)' +
		'|50(9[0-9][0-9][0-9])' +
		'|627780' +
		'|63(6297|6368)' +
		'|650(' +
		'03([^4])' +
		'|04([0-9])' +
		'|05(0|1)' +
		'|05([7-9])' +
		'|06([0-9])' +
		'|07([0-9])' +
		'|08([0-9])' +
		'|4(' +
		'[0-3][0-9]' +
		'|8[5-9]' +
		'|9[0-9]' +
		')' +
		'|5(' +
		'\\d\\d' +
		'|3[0-8]' +
		')' +
		'|9(' +
		'[0-6][0-9]' +
		'|7[0-8]' +
		')' +
		'|7([0-2][0-9])' +
		'|541|700|720|727|901' +
		'|09dd' +
		')' +
		'|65165([2-9])' +
		'|6516([6-7][0-9])' +
		'|65500([0-9])' +
		'|6550([0-5][0-9])' +
		'|655021' +
		'|65505([6-7])' +
		'|6516([8-9][0-9])' +
		'|65170([0-4])' +
		'|6509\\d{2}' +
		')'
	return new RegExp(exp)
}

const discoverPattern = () => {
	return new RegExp('^(6011|65(?!' + eloDiscover() + ')|64[4-9]|622)')
}

const eloDiscover = () => {
	var exp =
		'(' +
		'0(' +
		'0(' +
		'3[5679]' +
		'|4' +
		'|5[01]\\d' +
		'|9{1,2}1' +
		')' +
		'|4(' +
		'0[5-9]' +
		'|[1-3]' +
		'|8[5-9]' +
		'|9' +
		')\\d?' +
		'|5(' +
		'[0-2]' +
		'|3[0-8]' +
		'|4[1-9]' +
		'|[5-8]' +
		'|9[0-8]' +
		')\\d?' +
		'|7(' +
		'0\\d' +
		'|1[0-8]' +
		'|2[0-7]' +
		')' +
		'|9(' +
		'0[1-9]' +
		'|1\\d' +
		'|[2-6][0-9]' +
		'|7[0-8]' +
		'|91' +
		')' +
		')' +
		'|1(' +
		'6(' +
		'5[2-9]' +
		'|[6-9]\\d' +
		')' +
		'|70[0-4]' +
		')' +
		'|50(0|1|2|[3-4]|5[0-8])\\d?' +
		')'
	return exp
}

const cardPatterns = {
	amex: /^3[47]/,
	dankort: /^5019/,
	dinersclub: /^(36|38(?![4][1][0|4|6][0])[0-9]*|30|39|2149|2014)/,
	jcb: /^35/,
	sorocred: /^(5057|6278|6364|606014)/,
	laser: /^(6706|6771|6709)/,
	maestro: /^(50(18|20|38)|6(304|7(0[38]|59|6[1-3])))/,
	mastercard: /^(5[1-5]|677189)|^(2(2(?=([2-9]{1}[0-9]{1}))|7(?=[0-2]{1}0)|[3-6](?=[0-9])))/,
	unionpay: /^62(9|778[1-9])/,
	visaelectron: /^4(026|17500|405|508|844|91[37])/,
	visa: /^4/,
	hipercard: /^(606282|60((?!11)(?!6014)\d{4})|3841[0|4|6]0)/,
	elo: eloPattern(),
	discover: discoverPattern()
}

export const getCardBrand = cardNumber => {
	for (const brand in cardPatterns) {
		if (cardPatterns[brand].test(cardNumber)) {
			return brand
		}
	}
	return ''
}
